DatumStructure:
  - StoreName: AllNodes
    StoreProvider: Datum::File
    StoreOptions:
      Path: "./AllNodes"
 
  - StoreName: SiteData
    StoreProvider: Datum::File
    StoreOptions:
      Path: "./SiteData"

  - StoreName: Environments
    StoreProvider: Datum::File
    StoreOptions:
      Path: "./Environments"

  - StoreName: Roles
    StoreProvider: Datum::File
    StoreOptions:
      Path: "./Roles"


ResolutionPrecedence:
  - 'AllNodes\$($Node.Environment)\$($Node.Name)'
  - 'AllNodes\$($Node.Environment)\All'
  - 'Environments\$($Node.Environment)'
  - 'SiteData\$($Node.Location)'
  - 'Roles\$($Node.Role)' 
  - 'Roles\All'

DatumHandlers:
  Datum::TestHandler: #Datum\Test-TestHandlerFilter & Invoke-TestHandlerAction
    Filter: $False #$InputObject -is [string] -and $InputObject -match "^\[TEST=[\w\W]*\]$"
    Action: $handler #Get-Process
    CommandOptions:
      Password: P@ssw0rd      
  # Datum::ProtectedData: # Datum\Test-ProtectedDataFilter & Invoke-ProtectedDataAction
  #   Filter: $InputObject -is [string] -and $InputObject -match "^\[ENC=[\w\W]*\]$"
  #   Action: $Datum #Unprotect-Datum -Base64Data $InputObject @CommandOptions
  #   CommandOptions:
  #     Password: P@ssw0rd
      ### THUMBPRINT ###
  # Datum::FollowRedirection:
  #   Filter: $false #$InputObject -is [string] -and $InputObject -match "^\[REF=.*\]$"
  #   Action: Resolve-Datum -PropertyPath ($InputObject -replace '^\[REF=').TrimEnd(']') -DatumTre $Datum -Variable $Node
  # Datum::Interpolation:
  #   Filter: $InputObject -is [string] -and $InputObject -match '\%\{.*\}'
  #   Action: Get-InterpolatedDatum $InputObject


# That's the default
# default_lookup_options: MostSpecific
# default_lookup_options:
#   strategy: MostSpecific
#   MaxDepth: -1
default_lookup_options: # equivalent to adding ^.* in lookup_option
  strategy: first|unique|hash|deep
  options:
    knockout_prefix: --
    sort_merged_arrays: false
    merge_hash_arrays: false


# Can override for all
lookup_options:
  a: first
  d: unique
  c: hash
  b: deep
  configurations: Unique

  '^.*\\': 
    strategy: deep
    options:
      knockout_prefix: --
      sort_merged_arrays: false
      merge_hash_arrays: false

# lookup_options:
#   lookup_options: #when a Configuration defines a merge behaviour, it can be overriden here
#     merge: hash
#   Configurations:
#     merge: Unique
#   Shared1:
#     merge:
#       Strategy: deep
#       knockoutPrefix: --
#   SoftwareBase\Packages\Sources:
#     merge: 
#       strategy: ArrayOfUniqueHashByPropertyName
#       PropertyName: Name
#   #how to support regex when path separator is \